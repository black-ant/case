<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-LLM Provider Demo - å¤š LLM æä¾›å•†æ¼”ç¤º</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; }
        h1 { color: #333; margin-bottom: 30px; text-align: center; }
        .providers-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(500px, 1fr)); gap: 20px; }
        .provider-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .provider-card h2 { color: #2c3e50; margin-bottom: 15px; font-size: 18px; display: flex; align-items: center; gap: 10px; }
        .provider-icon { font-size: 24px; }
        .input-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; color: #555; font-weight: 500; font-size: 14px; }
        textarea { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; min-height: 80px; resize: vertical; font-family: inherit; }
        .button-group { display: flex; gap: 10px; }
        button { flex: 1; color: white; border: none; padding: 10px; border-radius: 4px; cursor: pointer; font-size: 14px; }
        button:hover { opacity: 0.9; }
        .btn-chat { background: #3498db; }
        .btn-stream { background: #9b59b6; }
        .response { margin-top: 15px; padding: 15px; background: #f8f9fa; border-left: 4px solid #3498db; border-radius: 4px; white-space: pre-wrap; word-wrap: break-word; max-height: 300px; overflow-y: auto; }
        .error { border-left-color: #e74c3c; background: #fee; }
        .loading { color: #3498db; font-style: italic; }
        .provider-info { font-size: 12px; color: #7f8c8d; margin-bottom: 10px; }
        .openai { border-top: 3px solid #10a37f; }
        .azure { border-top: 3px solid #0078d4; }
        .anthropic { border-top: 3px solid #d97757; }
        .gemini { border-top: 3px solid #4285f4; }
        .ollama { border-top: 3px solid #000000; }
        .health-check { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); text-align: center; }
        .health-status { display: inline-block; padding: 8px 16px; border-radius: 4px; font-weight: 500; }
        .health-ok { background: #d4edda; color: #155724; }
        .health-error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ Multi-LLM Provider Demo - å¤š LLM æä¾›å•†æ¼”ç¤º</h1>

        <div class="health-check">
            <button onclick="checkHealth()" style="background: #27ae60;">æ£€æŸ¥æœåŠ¡çŠ¶æ€</button>
            <div id="healthStatus"></div>
        </div>

        <div class="providers-grid">
            <!-- OpenAI -->
            <div class="provider-card openai">
                <h2><span class="provider-icon">ğŸ¤–</span> OpenAI (GPT-3.5/GPT-4)</h2>
                <div class="provider-info">æœ€æµè¡Œçš„å•†ä¸š LLMï¼ŒAPI ç®€å•æ˜“ç”¨</div>
                <div class="input-group">
                    <label>è¾“å…¥æ¶ˆæ¯ï¼š</label>
                    <textarea id="openaiMessage" placeholder="ä¾‹å¦‚ï¼šè¯·ä»‹ç»ä¸€ä¸‹ Spring AI">è¯·ä»‹ç»ä¸€ä¸‹ Spring AI</textarea>
                </div>
                <div class="button-group">
                    <button class="btn-chat" onclick="chat('openai')">æ™®é€šå¯¹è¯</button>
                    <button class="btn-stream" onclick="stream('openai')">æµå¼å¯¹è¯</button>
                </div>
                <div id="openaiResponse"></div>
            </div>

            <!-- Azure OpenAI -->
            <div class="provider-card azure">
                <h2><span class="provider-icon">â˜ï¸</span> Azure OpenAI</h2>
                <div class="provider-info">ä¼ä¸šçº§éƒ¨ç½²ï¼Œæ•°æ®éšç§ä¿æŠ¤ï¼ŒSLA ä¿éšœ</div>
                <div class="input-group">
                    <label>è¾“å…¥æ¶ˆæ¯ï¼š</label>
                    <textarea id="azureMessage" placeholder="ä¾‹å¦‚ï¼šä»€ä¹ˆæ˜¯äº‘è®¡ç®—ï¼Ÿ">ä»€ä¹ˆæ˜¯äº‘è®¡ç®—ï¼Ÿ</textarea>
                </div>
                <div class="button-group">
                    <button class="btn-chat" onclick="chat('azure')">æ™®é€šå¯¹è¯</button>
                    <button class="btn-stream" onclick="stream('azure')">æµå¼å¯¹è¯</button>
                </div>
                <div id="azureResponse"></div>
            </div>

            <!-- Anthropic Claude -->
            <div class="provider-card anthropic">
                <h2><span class="provider-icon">ğŸ§ </span> Anthropic Claude</h2>
                <div class="provider-info">é•¿ä¸Šä¸‹æ–‡ï¼ˆ200K tokensï¼‰ï¼Œå®‰å…¨æ€§å¼º</div>
                <div class="input-group">
                    <label>è¾“å…¥æ¶ˆæ¯ï¼š</label>
                    <textarea id="anthropicMessage" placeholder="ä¾‹å¦‚ï¼šè§£é‡Šä¸€ä¸‹æœºå™¨å­¦ä¹ ">è§£é‡Šä¸€ä¸‹æœºå™¨å­¦ä¹ </textarea>
                </div>
                <div class="button-group">
                    <button class="btn-chat" onclick="chat('anthropic')">æ™®é€šå¯¹è¯</button>
                    <button class="btn-stream" onclick="stream('anthropic')">æµå¼å¯¹è¯</button>
                </div>
                <div id="anthropicResponse"></div>
            </div>

            <!-- Google Gemini -->
            <div class="provider-card gemini">
                <h2><span class="provider-icon">âœ¨</span> Google Gemini</h2>
                <div class="provider-info">å¤šæ¨¡æ€æ”¯æŒï¼ŒGoogle ç”Ÿæ€é›†æˆ</div>
                <div class="input-group">
                    <label>è¾“å…¥æ¶ˆæ¯ï¼š</label>
                    <textarea id="geminiMessage" placeholder="ä¾‹å¦‚ï¼šä»‹ç»ä¸€ä¸‹ Google AI">ä»‹ç»ä¸€ä¸‹ Google AI</textarea>
                </div>
                <div class="button-group">
                    <button class="btn-chat" onclick="chat('gemini')">æ™®é€šå¯¹è¯</button>
                    <button class="btn-stream" onclick="stream('gemini')">æµå¼å¯¹è¯</button>
                </div>
                <div id="geminiResponse"></div>
            </div>

            <!-- Ollama -->
            <div class="provider-card ollama">
                <h2><span class="provider-icon">ğŸ¦™</span> Ollama (æœ¬åœ°æ¨¡å‹)</h2>
                <div class="provider-info">å®Œå…¨æœ¬åœ°è¿è¡Œï¼Œæ•°æ®ç§æœ‰ï¼Œå…è´¹ä½¿ç”¨</div>
                <div class="input-group">
                    <label>è¾“å…¥æ¶ˆæ¯ï¼š</label>
                    <textarea id="ollamaMessage" placeholder="ä¾‹å¦‚ï¼šä½ å¥½ï¼Œä»‹ç»ä¸€ä¸‹è‡ªå·±">ä½ å¥½ï¼Œä»‹ç»ä¸€ä¸‹è‡ªå·±</textarea>
                </div>
                <div class="button-group">
                    <button class="btn-chat" onclick="chat('ollama')">æ™®é€šå¯¹è¯</button>
                    <button class="btn-stream" onclick="stream('ollama')">æµå¼å¯¹è¯</button>
                </div>
                <div id="ollamaResponse"></div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080/api/llm';

        async function checkHealth() {
            const statusDiv = document.getElementById('healthStatus');
            statusDiv.innerHTML = '<div class="loading">æ­£åœ¨æ£€æŸ¥...</div>';
            
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();
                
                let html = '<div style="margin-top: 15px;">';
                for (const [provider, status] of Object.entries(data)) {
                    const statusClass = status === 'OK' ? 'health-ok' : 'health-error';
                    html += `<span class="health-status ${statusClass}" style="margin: 5px;">${provider}: ${status}</span>`;
                }
                html += '</div>';
                statusDiv.innerHTML = html;
            } catch (error) {
                statusDiv.innerHTML = `<div class="health-status health-error" style="margin-top: 15px;">æ£€æŸ¥å¤±è´¥: ${error.message}</div>`;
            }
        }

        async function chat(provider) {
            const message = document.getElementById(`${provider}Message`).value;
            if (!message) return alert('è¯·è¾“å…¥æ¶ˆæ¯');

            const responseDiv = document.getElementById(`${provider}Response`);
            responseDiv.innerHTML = '<div class="response loading">æ­£åœ¨è¯·æ±‚...</div>';

            try {
                const response = await fetch(`${API_BASE}/${provider}/chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message })
                });

                const data = await response.json();
                const duration = data.duration ? ` (${data.duration}ms)` : '';
                responseDiv.innerHTML = `<div class="response">
                    <strong>${data.provider} - ${data.model}${duration}</strong><br><br>
                    ${data.response}
                </div>`;
            } catch (error) {
                responseDiv.innerHTML = `<div class="response error">é”™è¯¯: ${error.message}<br><br>æç¤ºï¼šè¯·ç¡®ä¿å·²é…ç½® API Key å¹¶ä¸”æœåŠ¡æ­£å¸¸è¿è¡Œ</div>`;
            }
        }

        async function stream(provider) {
            const message = document.getElementById(`${provider}Message`).value;
            if (!message) return alert('è¯·è¾“å…¥æ¶ˆæ¯');

            const responseDiv = document.getElementById(`${provider}Response`);
            responseDiv.innerHTML = '<div class="response loading">æ­£åœ¨è¿æ¥æµå¼å“åº”...</div>';

            try {
                const response = await fetch(`${API_BASE}/${provider}/stream`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message })
                });

                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let fullText = '';

                responseDiv.innerHTML = '<div class="response"></div>';
                const contentDiv = responseDiv.querySelector('.response');

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    const chunk = decoder.decode(value);
                    const lines = chunk.split('\n');
                    
                    for (const line of lines) {
                        if (line.startsWith('data: ')) {
                            const text = line.substring(6);
                            if (text && text !== '[DONE]') {
                                fullText += text;
                                contentDiv.textContent = fullText;
                            }
                        }
                    }
                }
            } catch (error) {
                responseDiv.innerHTML = `<div class="response error">é”™è¯¯: ${error.message}<br><br>æç¤ºï¼šè¯·ç¡®ä¿å·²é…ç½® API Key å¹¶ä¸”æœåŠ¡æ­£å¸¸è¿è¡Œ</div>`;
            }
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æ£€æŸ¥å¥åº·çŠ¶æ€
        window.onload = () => {
            checkHealth();
        };
    </script>
</body>
</html>
