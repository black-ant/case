# API é…ç½®è¯´æ˜

## ğŸ”§ åŒ API æ¶æ„

æœ¬é¡¹ç›®ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„ API æä¾›å•†ï¼Œå®ç°æœ€ä¼˜é…ç½®ï¼š

### 1. Chat API - DeepSeek (gemini-2.5-pro)
ç”¨äºå¯¹è¯ç”Ÿæˆå’Œ Function Calling

**é…ç½®ï¼š**
```yaml
spring:
  ai:
    openai:
      api-key: sk-4ZkNj89GHt26K4lyfl1JNOQuPtUeV5ktXUs8T1VbJ1iS7R5Y
      base-url: https://992236.xyz
      chat:
        options:
          model: gemini-2.5-pro
          temperature: 0.7
          max-tokens: 2000
```

**ç”¨é€”ï¼š**
- âœ… å¯¹è¯ç”Ÿæˆ
- âœ… Function Calling
- âœ… æµå¼å“åº”
- âœ… ä¸Šä¸‹æ–‡ç†è§£

### 2. Embeddings API - SiliconFlow
ç”¨äºæ–‡æœ¬å‘é‡åŒ–å’Œè¯­ä¹‰æœç´¢

**é…ç½®ï¼š**
```yaml
embeddings:
  api-key: sk-vgerpwjpbonxajygdzkqjkitstqjshsikflawxzqhcgzecum
  base-url: https://api.siliconflow.cn/v1
  model: BAAI/bge-large-zh-v1.5
```

**ç”¨é€”ï¼š**
- âœ… æ–‡æ¡£å‘é‡åŒ–
- âœ… è¯­ä¹‰ç›¸ä¼¼åº¦æœç´¢
- âœ… RAG çŸ¥è¯†åº“æ£€ç´¢

## ğŸ¯ ä¸ºä»€ä¹ˆä½¿ç”¨ä¸¤ä¸ª APIï¼Ÿ

### ä¼˜åŠ¿

1. **ä¸“ä¸šåˆ†å·¥**
   - Chat APIï¼šä¸“æ³¨äºå¯¹è¯ç”Ÿæˆ
   - Embeddings APIï¼šä¸“æ³¨äºå‘é‡åŒ–

2. **æˆæœ¬ä¼˜åŒ–**
   - ä½¿ç”¨æœ€é€‚åˆçš„æ¨¡å‹
   - é¿å…å•ä¸€ API çš„é™åˆ¶

3. **ç¨³å®šæ€§**
   - åˆ†æ•£é£é™©
   - äº’ä¸å½±å“

4. **çµæ´»æ€§**
   - å¯ä»¥ç‹¬ç«‹æ›´æ¢
   - å¯ä»¥ç‹¬ç«‹ä¼˜åŒ–

## ğŸ”„ å¦‚ä½•è‡ªå®šä¹‰é…ç½®

### æ–¹æ³• 1ï¼šç¯å¢ƒå˜é‡

```bash
# Chat API
export DEEPSEEK_API_KEY=your-chat-api-key
export DEEPSEEK_API_URL=your-chat-api-url
export DEEPSEEK_MODEL=your-chat-model

# Embeddings API
export EMBEDDINGS_API_KEY=your-embeddings-api-key
export EMBEDDINGS_API_URL=your-embeddings-api-url
export EMBEDDINGS_MODEL=your-embeddings-model
```

### æ–¹æ³• 2ï¼šä¿®æ”¹ application.yml

ç›´æ¥ç¼–è¾‘ `src/main/resources/application.yml` æ–‡ä»¶ã€‚

### æ–¹æ³• 3ï¼šå¯åŠ¨å‚æ•°

```bash
mvn spring-boot:run \
  -Dspring-boot.run.arguments="\
    --spring.ai.openai.api-key=your-key \
    --embeddings.api-key=your-key"
```

## ğŸ“Š æ”¯æŒçš„æ¨¡å‹

### Chat æ¨¡å‹
- gemini-2.5-pro (æ¨è)
- deepseek-chat
- deepseek-coder
- gpt-4o-mini
- å…¶ä»– OpenAI å…¼å®¹æ¨¡å‹

### Embeddings æ¨¡å‹
- BAAI/bge-large-zh-v1.5 (æ¨èï¼Œä¸­æ–‡)
- BAAI/bge-base-zh-v1.5
- text-embedding-3-small
- text-embedding-3-large

## ğŸ” éªŒè¯é…ç½®

### 1. æ£€æŸ¥ Chat API
å¯åŠ¨åº”ç”¨åï¼Œå‘é€ä¸€æ¡æ¶ˆæ¯ï¼ŒæŸ¥çœ‹æ˜¯å¦æ­£å¸¸å›å¤ã€‚

### 2. æ£€æŸ¥ Embeddings API
æŸ¥è¯¢çŸ¥è¯†åº“ç›¸å…³é—®é¢˜ï¼Œå¦‚"é€€è´§æ”¿ç­–æ˜¯ä»€ä¹ˆï¼Ÿ"

### 3. æŸ¥çœ‹æ—¥å¿—
```
DEBUG çº§åˆ«æ—¥å¿—ä¼šæ˜¾ç¤º API è°ƒç”¨è¯¦æƒ…
```

## ğŸ› å¸¸è§é—®é¢˜

### Q1: Chat API è°ƒç”¨å¤±è´¥
- æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ base-url æ˜¯å¦å¯è®¿é—®
- æ£€æŸ¥æ¨¡å‹åç§°æ˜¯å¦æ­£ç¡®

### Q2: Embeddings API è°ƒç”¨å¤±è´¥
- æ£€æŸ¥ embeddings.api-key
- æ£€æŸ¥ embeddings.base-url
- ç¡®è®¤æ¨¡å‹æ”¯æŒ embeddings ç«¯ç‚¹

### Q3: çŸ¥è¯†åº“æ£€ç´¢ä¸å‡†ç¡®
- å°è¯•æ›´æ¢ embeddings æ¨¡å‹
- è°ƒæ•´ Top-K å€¼
- ä¼˜åŒ–çŸ¥è¯†åº“å†…å®¹

### Q4: å¦‚ä½•åªä½¿ç”¨ä¸€ä¸ª APIï¼Ÿ
å¦‚æœä½ çš„ API åŒæ—¶æ”¯æŒ Chat å’Œ Embeddingsï¼š
```yaml
spring:
  ai:
    openai:
      api-key: your-unified-key
      base-url: your-unified-url

embeddings:
  api-key: ${spring.ai.openai.api-key}
  base-url: ${spring.ai.openai.base-url}
  model: text-embedding-3-small
```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **ä½¿ç”¨ç¯å¢ƒå˜é‡**
   - ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç  API Key
   - ä½¿ç”¨ `.env` æ–‡ä»¶ç®¡ç†é…ç½®

2. **ç›‘æ§ API ä½¿ç”¨**
   - å®šæœŸæ£€æŸ¥ API è°ƒç”¨é‡
   - è®¾ç½®ä½¿ç”¨é™åˆ¶

3. **å¤‡ç”¨æ–¹æ¡ˆ**
   - å‡†å¤‡å¤‡ç”¨ API Key
   - é…ç½®å¤šä¸ª API æä¾›å•†

4. **å®‰å…¨æ€§**
   - å®šæœŸæ›´æ¢ API Key
   - é™åˆ¶ API Key æƒé™

---

é…ç½®å®Œæˆåï¼Œé‡å¯åº”ç”¨å³å¯ç”Ÿæ•ˆï¼ğŸš€
