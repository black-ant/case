# 快速启动指南

## 1️⃣ 环境准备

### 设置 OpenAI API Key

**Windows (CMD):**
```cmd
set OPENAI_API_KEY=your-api-key-here
```

**Windows (PowerShell):**
```powershell
$env:OPENAI_API_KEY="your-api-key-here"
```

**Linux/Mac:**
```bash
export OPENAI_API_KEY=your-api-key-here
```

## 2️⃣ 启动应用

在项目根目录执行：

```bash
cd AI-Customer-Service
mvn clean spring-boot:run
```

## 3️⃣ 访问应用

打开浏览器访问：**http://localhost:8080**

## 4️⃣ 测试场景

### 场景 1：查询订单
```
输入：查询我的订单
或：我的订单号是 ORD20251019001
```

### 场景 2：查询物流
```
输入：查询订单 ORD20251019001 的物流信息
```

### 场景 3：咨询政策
```
输入：退货政策是什么？
或：配送需要多久？
或：支持哪些支付方式？
```

### 场景 4：创建工单
```
输入：我收到的商品有质量问题
然后：描述具体问题
```

### 场景 5：多轮对话
```
1. 查询我的订单
2. 第一个订单的物流信息
3. 我想退货
4. 帮我创建退货工单
```

## 5️⃣ 测试账号

系统预置了以下测试数据：

**客户 1：张三 (CUST001)**
- 订单 ORD20251019001：iPhone 15 Pro（已发货）
- 订单 ORD20251019002：AirPods Pro（已送达）

**客户 2：李四 (CUST002)**
- 订单 ORD20251019003：MacBook Pro（已确认）

## 6️⃣ API 测试

### 使用 curl 测试

**创建会话：**
```bash
curl -X POST http://localhost:8080/api/customer-service/session \
  -H "Content-Type: application/json" \
  -d '{"customerId":"CUST001","customerName":"张三"}'
```

**发送消息：**
```bash
curl -X POST http://localhost:8080/api/customer-service/chat \
  -H "Content-Type: application/json" \
  -d '{
    "sessionId":"your-session-id",
    "customerId":"CUST001",
    "message":"查询我的订单"
  }'
```

**流式响应：**
```bash
curl -X POST http://localhost:8080/api/customer-service/chat/stream \
  -H "Content-Type: application/json" \
  -d '{
    "sessionId":"your-session-id",
    "customerId":"CUST001",
    "message":"退货政策是什么？"
  }'
```

## 7️⃣ 查看数据库

访问 H2 控制台：**http://localhost:8080/h2-console**

- JDBC URL: `jdbc:h2:mem:customerservice`
- Username: `sa`
- Password: (留空)

可以查看的表：
- `CHAT_SESSIONS` - 会话记录
- `CHAT_MESSAGES` - 消息历史
- `ORDERS` - 订单信息
- `CUSTOMER_TICKETS` - 工单记录

## 8️⃣ 功能演示

### RAG 知识库检索
问任何关于政策的问题，系统会自动从知识库检索相关信息。

### Function Calling
当你询问订单、物流或需要创建工单时，AI 会自动调用相应的工具函数。

### 流式响应
勾选"流式响应"选项，可以看到 AI 逐字输出回复。

### 多轮对话
系统会记住对话历史，支持上下文相关的多轮对话。

## 🐛 常见问题

### 1. 启动失败
- 检查 JDK 版本是否为 17+
- 检查 8080 端口是否被占用
- 检查 OPENAI_API_KEY 是否设置

### 2. AI 不回复
- 检查 API Key 是否有效
- 检查网络连接
- 查看控制台日志

### 3. Function 不调用
- 确保问题明确（如"查询订单 ORD20251019001"）
- 检查日志中的 Function Calling 信息

## 📞 获取帮助

如有问题，请查看：
- 控制台日志
- H2 数据库中的数据
- README.md 详细文档
